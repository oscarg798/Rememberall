plugins {
    id "com.android.application"
    id "kotlin-android"
    id 'kotlin-parcelize'
    id 'kotlin-kapt'
    id 'androidx.navigation.safeargs.kotlin'
    id 'dagger.hilt.android.plugin'
    id 'com.google.gms.google-services'
}
apply plugin: 'kotlin-android'
apply from: "../ktlint.gradle"
apply from: "../signin.gradle"
apply from: "../config.gradle"

android {

    compileSdk = 30
    buildToolsVersion = "30.0.3"

    defaultConfig {
        applicationId = "com.oscarg798.remembrall"
        minSdk = 26
        targetSdk = 30
        versionCode = 1
        versionName = "1.0"

        buildConfigField "String", "GoogleClientId", "\"$googleCLientId\""

        testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"

        javaCompileOptions {
            annotationProcessorOptions {
                arguments += [
                        "room.schemaLocation": "$projectDir/schemas".toString(),
                        "room.incremental"   : "true"]
            }
        }
    }

    buildTypes {
        debug {
            signingConfig signingConfigs.locker
        }
        release {
            signingConfig signingConfigs.locker
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    kotlinOptions {
        freeCompilerArgs = ["-Xallow-result-return-type",
                            "-Xopt-in=kotlinx.coroutines.ExperimentalCoroutinesApi",
                            "-Xopt-in=androidx.compose.foundation.ExperimentalFoundationApi",
                            "-Xopt-in=kotlinx.coroutines.FlowPreview",
                            "-Xopt-in=kotlin.contracts.ExperimentalContracts"]
        jvmTarget = "1.8"
        useIR = true
    }

    testOptions {
        //execution 'ANDROIDX_TEST_ORCHESTRATOR'
        unitTests {
            includeAndroidResources true
        }
    }

    buildFeatures {
        viewBinding false
        dataBinding false
        compose true
    }

    composeOptions {
        kotlinCompilerVersion "1.4.32"
        kotlinCompilerExtensionVersion '1.0.0-beta07'
    }

    repositories {
        google()
        jcenter {
            content {
                includeModule("org.jetbrains.kotlinx", "kotlinx-collections-immutable-jvm")
            }
        }
    }
}

dependencies {

    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"

    implementation androidX.coreKtx
    implementation androidX.appCompat
    implementation material.material

    implementation androidX.constraintLayout
    testImplementation testing.junit
    androidTestImplementation testing.AndroidXJunit
    androidTestImplementation testing.espressoCore

    implementation daggerHilt.android
    implementation daggerHilt.compose
    implementation daggerHilt.work
    implementation daggerHilt.compiler
    kapt daggerHilt.daggerCompiler
    kaptAndroidTest daggerHilt.compiler

    implementation 'com.google.guava:listenablefuture:9999.0-empty-to-avoid-conflict-with-guava'

    implementation androidXlifecycle.savedState
    implementation androidXlifecycle.core
    implementation androidXlifecycle.viewModel

    implementation compose.liveData
    implementation compose.ui
    implementation compose.tooling
    implementation compose.foundation
    implementation compose.material
    implementation compose.icons
    implementation compose.iconsExtended
    implementation compose.animations
    implementation compose.constraintLayout
    implementation compose.compiler
    implementation compose.activities

    implementation navigationComponent.fragment
    implementation navigationComponent.ui
    implementation navigationComponent.fragmentKtx
    implementation navigationComponent.uiKtx
    implementation navigationComponent.compose

    implementation retrofit.gsonConverter
    implementation retrofit.okhttpLoggingInterceptor
    implementation retrofit.okhttp3
    implementation retrofit.gson

    implementation lottie.main
    implementation lottie.compose

    implementation room.runtime
    implementation room.ktx
    kapt room.compiler

    implementation arrow.core

    implementation workManager.ktx

    implementation utils.composeDialogs
    implementation 'org.jetbrains.kotlin:kotlin-reflect:1.4.32'
    implementation androidGms.auth
    implementation platform(firebase.boom)

    testImplementation mockk.mockk
    testImplementation kotlinCoroutinesTest

}
repositories {
    google()
    mavenCentral()
    maven { url "https://oss.sonatype.org/content/repositories/snapshots/" }
}
